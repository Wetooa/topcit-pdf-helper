LEARNING GUIDE: Pages 28-32
Generated: 2026-02-10 21:01:04
PDF: Cyber Academia-Penetration Testing Day 4

================================================================================
LEARNING GUIDE
================================================================================

Here is a simplified, easy-to-read learning guide based on the provided text:

---

**Learning Guide: Pentest Report Analysis & Vulnerability Scoring**

---

### **1. Command Injection Vulnerability**

*   **Vulnerability Type:** Command Injection
*   **Description:** Attackers can execute arbitrary commands on a victim's system by injecting malicious code into installation or cluster join scripts. This happens because user-provided input from URL paths is embedded directly into bash script templates *without proper sanitization*.
*   **How it Works (Technical Details):**
    *   **Input Source:** The system takes user-provided values (e.g., version numbers for installation, or server profiles for cluster joining) directly from the URL path.
    *   **Processing Flaw:** This input is then used to dynamically generate bash scripts.
    *   **Lack of Sanitization:** The crucial flaw is that there's no filtering or validation (sanitization) of the user input before it's placed into these scripts.
    *   **Execution:** When a victim runs the generated script (e.g., by piping it to `bash`), the attacker's injected commands are executed on their machine.
*   **Specific Injection Points Identified:**
    *   **Installation Script:** The `install` endpoint's script embeds the `version` parameter from the URL path directly.
    *   **Cluster Join Script:** The `GetSiteInstructions()` function reflects the `serverProfile` parameter (from the URL) into its generated script without sanitization.
*   **Reproduction (How to Verify):**
    *   An attacker crafts a malicious URL containing URL-encoded commands (e.g., `${touch evil_file}` or `$(sleep 10)`).
    *   When the system generates a script based on this URL, the injected command becomes part of the script.
    *   If a victim downloads and executes this script (e.g., `curl malicious_url | bash`), the injected command will run on their system.
*   **Impact:**
    *   **Arbitrary Command Execution:** Attackers can run any command on the victim's workstation.
    *   **Deception:** Victims can be easily tricked into using malicious links, especially if the domain appears legitimate.
*   **Complexity for Attacker:** Low; the attacker primarily needs to trick a victim into clicking or using a specially crafted malicious link.
*   **Remediation:**
    *   **Input Sanitization:** All user-supplied values (like version numbers and server roles) *must* be thoroughly sanitized (validated, filtered, or escaped) before being embedded into any script or template.

---

### **2. Common Vulnerability Scoring System (CVSS)**

*   **Purpose:** CVSS is a standardized, open framework used to assess and communicate the characteristics and impact of IT vulnerabilities.
*   **Severity Levels (Based on Base Scores):**
    *   **Low:** 0.1 – 3.9
    *   **Medium:** 4.0 – 6.9
    *   **High:** 7.0 – 8.9
    *   **Critical:** 9.0 – 10.0

---

================================================================================
ORIGINAL TEXT (First 5000 chars)
================================================================================

--- Page 28 ---
REPORTING: Pentest Technical Report

Description
To install Fe sy client the user documentation recommends to execute the following command:
b B Al a p Lol Sl Colll WG - bl B

The installation script is dynamically generated by the g === to include details for the version
requested by the user.

During testing, we discovered that the version taken from the URL path is parsed using © . r and
included within the template bash script with no sanitization.

#!/bin/bash
# This script downloads the [lversionl! build of t »e and installs it on the target machine

As a result, an attacker can craft a URL that will include arbitrary commands within the installation script.
Please note that other injection points exist within the same script.

A similar problem occurs in the endpoint used to join a cluster. The GetSitelnstructions() function does
not sanitize the serverProfile parameter which is reflected in the following script:

s T FEI | b * LB el BS ) B o S
--token=95 ic \

--advertise-addr- \

--role-fi i

--cloud-provider \

--operation-id-



--- Page 29 ---
REPORTING: Pentest Technical

Reproduction Steps

This issue can be verified with a simple unauthenticated HTTP request:

$Scurll s r w ok e nstall/1.01-

- mos

aaan24% ~ - 3%29

Where the URL encoded path contains ${touch grav). Such command will be included in the resulting
script. Piping the script to bash leads to system command execution on the victim's workstation.

The second issue can be verified using the following unauthenticated request:

$CUI’[httpS://FIIJLI - = - i . - L
%24% %29

Where the URL encoded path contains S(sleep 10).



--- Page 30 ---
REPORTING: Pentest Technical Report

Impact

A victim user could be tricked into using an attacker's provided installation URL. The fact that the domain

and the resource are actually hosted on g @e* 2= 8 may reinforce the perception that the
installation script is legitimate.

Complexity
An attacker would need to trick the victim into installing tele using a malicious link.

Remediation

Sanitize version numbers and server roles before using user-supplied values within bash script
templates.

Resources



--- Page 31 ---
REPORTING: Common Vulnerability 
Scoring System (CVSS)
The Common Vulnerability Scoring System(CVSS) is used 
to assess the impact of vulnerabilities. There are 4 types 
of Severity as shown in the table below
Severity Base Score
Low 0.1 – 3.9 
Medium 4.0 - 6.9
High 7.0 – 8.9
Critical 9.0 – 10.0

--- Page 32 ---
REPORTING: Common Vulnerability 
Scoring System (CVSS)


